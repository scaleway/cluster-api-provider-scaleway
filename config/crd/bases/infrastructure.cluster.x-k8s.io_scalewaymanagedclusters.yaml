---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  name: scalewaymanagedclusters.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: ScalewayManagedCluster
    listKind: ScalewayManagedClusterList
    plural: scalewaymanagedclusters
    shortNames:
    - smc
    singular: scalewaymanagedcluster
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Cluster to which this ScalewayManagedCluster belongs
      jsonPath: .metadata.labels.cluster\.x-k8s\.io/cluster-name
      name: Cluster
      type: string
    - description: Ready is true when the managed cluster is fully provisioned
      jsonPath: .status.ready
      name: Ready
      type: boolean
    - description: Region of the managed cluster
      jsonPath: .spec.region
      name: Region
      type: string
    - description: Host of the control plane
      jsonPath: .spec.controlPlaneEndpoint.host
      name: Host
      type: string
    - description: Port of the control plane
      jsonPath: .spec.controlPlaneEndpoint.port
      name: Port
      type: integer
    deprecated: true
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: ScalewayManagedCluster is the Schema for the scalewaymanagedclusters
          API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired state of ScalewayManagedCluster
            properties:
              controlPlaneEndpoint:
                description: ControlPlaneEndpoint represents the endpoint used to
                  communicate with the control plane.
                properties:
                  host:
                    description: host is the hostname on which the API server is serving.
                    maxLength: 512
                    type: string
                  port:
                    description: port is the port on which the API server is serving.
                    format: int32
                    type: integer
                required:
                - host
                - port
                type: object
                x-kubernetes-validations:
                - message: Value is immutable
                  rule: self == oldSelf
              network:
                description: Network defines the network configuration of the managed
                  cluster.
                properties:
                  privateNetwork:
                    description: PrivateNetwork allows attaching machines of the cluster
                      to a Private Network.
                    properties:
                      id:
                        description: Set a Private Network ID to reuse an existing
                          Private Network.
                        type: string
                        x-kubernetes-validations:
                        - message: Value is immutable
                          rule: self == oldSelf
                      subnet:
                        description: Optional subnet for the Private Network. Only
                          used on newly created Private Networks.
                        type: string
                        x-kubernetes-validations:
                        - message: Value is immutable
                          rule: self == oldSelf
                      vpcID:
                        description: Set the VPC ID where the new Private Network
                          will be created.
                        type: string
                        x-kubernetes-validations:
                        - message: Value is immutable
                          rule: self == oldSelf
                    type: object
                    x-kubernetes-validations:
                    - message: vpcID cannot be added or removed
                      rule: has(self.vpcID) == has(oldSelf.vpcID)
                    - message: id cannot be added or removed
                      rule: has(self.id) == has(oldSelf.id)
                    - message: subnet cannot be added or removed
                      rule: has(self.subnet) == has(oldSelf.subnet)
                    - message: subnet cannot be set when id is set
                      rule: has(self.id) && !has(self.subnet) || !has(self.id)
                    - message: vpcID cannot be set when id is set
                      rule: has(self.id) && !has(self.vpcID) || !has(self.id)
                  publicGateways:
                    description: |-
                      PublicGateways allows to create Public Gateways that will be attached to the
                      Private Network of the cluster.
                    items:
                      description: PublicGatewaySpec defines Public Gateway settings
                        for the cluster.
                      properties:
                        ip:
                          description: IP to use when creating a Public Gateway.
                          format: ipv4
                          type: string
                        type:
                          default: VPC-GW-S
                          description: Public Gateway commercial offer type.
                          type: string
                        zone:
                          description: |-
                            Zone where to create the Public Gateway. Must be in the same region as the
                            cluster. Defaults to the first zone of the region.
                          type: string
                      type: object
                    maxItems: 6
                    type: array
                type: object
              projectID:
                description: ProjectID in which the managed cluster will be created.
                minLength: 2
                type: string
                x-kubernetes-validations:
                - message: Value is immutable
                  rule: self == oldSelf
              region:
                description: Region where the managed cluster will be created.
                minLength: 2
                type: string
                x-kubernetes-validations:
                - message: Value is immutable
                  rule: self == oldSelf
              scalewaySecretName:
                description: |-
                  ScalewaySecretName is the name of the secret that contains the Scaleway client parameters.
                  The following keys are required: SCW_ACCESS_KEY, SCW_SECRET_KEY.
                  The following key is optional: SCW_API_URL.
                minLength: 1
                type: string
            required:
            - projectID
            - region
            - scalewaySecretName
            type: object
            x-kubernetes-validations:
            - message: controlPlaneEndpoint is required once set
              rule: '!has(oldSelf.controlPlaneEndpoint) || has(self.controlPlaneEndpoint)'
            - message: privateNetwork cannot be added or removed
              rule: (has(self.network) && has(self.network.privateNetwork)) == (has(oldSelf.network)
                && has(oldSelf.network.privateNetwork))
          status:
            description: status defines the observed state of ScalewayManagedCluster
            properties:
              network:
                description: Network contains information about currently provisioned
                  network resources.
                properties:
                  privateNetworkID:
                    description: PrivateNetworkID is the ID of the Private Network
                      that is attached to the cluster.
                    type: string
                type: object
              ready:
                description: |-
                  Ready denotes that the Scaleway managed cluster infrastructure is fully provisioned.
                  NOTE: this field is part of the Cluster API contract and it is used to orchestrate provisioning.
                  The value of this field is never updated after provisioning is completed.
                type: boolean
            type: object
        required:
        - spec
        type: object
        x-kubernetes-validations:
        - message: name must be between 1 and 63 characters
          rule: self.metadata.name.size() <= 63
        - message: name must be a valid DNS label
          rule: self.metadata.name.matches('^[a-z0-9]([-a-z0-9]*[a-z0-9])?$')
    served: true
    storage: false
    subresources:
      status: {}
  - additionalPrinterColumns:
    - description: Cluster to which this ScalewayManagedCluster belongs
      jsonPath: .metadata.labels.cluster\.x-k8s\.io/cluster-name
      name: Cluster
      type: string
    - description: Provisioned is true when the cluster infrastructure is fully provisioned
      jsonPath: .status.initialization.provisioned
      name: Provisioned
      type: boolean
    - description: ScalewayManagedCluster pass all readiness checks
      jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - description: Region of the managed cluster
      jsonPath: .spec.region
      name: Region
      type: string
    - description: Host of the control plane
      jsonPath: .spec.controlPlaneEndpoint.host
      name: Host
      type: string
    - description: Port of the control plane
      jsonPath: .spec.controlPlaneEndpoint.port
      name: Port
      type: integer
    name: v1alpha2
    schema:
      openAPIV3Schema:
        description: ScalewayManagedCluster is the Schema for the scalewaymanagedclusters
          API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired state of ScalewayManagedCluster
            properties:
              controlPlaneEndpoint:
                description: controlPlaneEndpoint represents the endpoint used to
                  communicate with the control plane.
                minProperties: 1
                properties:
                  host:
                    description: host is the hostname on which the API server is serving.
                    maxLength: 512
                    minLength: 1
                    type: string
                  port:
                    description: port is the port on which the API server is serving.
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                type: object
                x-kubernetes-validations:
                - message: Value is immutable
                  rule: self == oldSelf
              network:
                description: network defines the network configuration of the managed
                  cluster.
                minProperties: 1
                properties:
                  privateNetwork:
                    description: privateNetwork allows attaching machines of the cluster
                      to a Private Network.
                    minProperties: 1
                    properties:
                      id:
                        description: id allows to reuse an existing Private Network
                          instead of creating a new one.
                        maxLength: 36
                        minLength: 36
                        pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$
                        type: string
                        x-kubernetes-validations:
                        - message: Value is immutable
                          rule: self == oldSelf
                      subnet:
                        description: subnet defines a subnet for the Private Network.
                          Only used on newly created Private Networks.
                        maxLength: 43
                        minLength: 1
                        type: string
                        x-kubernetes-validations:
                        - message: Value is immutable
                          rule: self == oldSelf
                        - message: value must be a valid CIDR network address
                          rule: isCIDR(self)
                      vpcID:
                        description: vpcID defines the ID of the VPC where the new
                          Private Network will be created if none is provided.
                        maxLength: 36
                        minLength: 36
                        pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$
                        type: string
                        x-kubernetes-validations:
                        - message: Value is immutable
                          rule: self == oldSelf
                    type: object
                    x-kubernetes-validations:
                    - message: vpcID cannot be added or removed
                      rule: has(self.vpcID) == has(oldSelf.vpcID)
                    - message: id cannot be added or removed
                      rule: has(self.id) == has(oldSelf.id)
                    - message: subnet cannot be added or removed
                      rule: has(self.subnet) == has(oldSelf.subnet)
                    - message: id and vpcID cannot be set at the same time
                      rule: '!has(self.id) || has(self.id) != has(self.vpcID)'
                    - message: id and subnet cannot be set at the same time
                      rule: '!has(self.id) || has(self.id) != has(self.subnet)'
                  publicGateways:
                    description: |-
                      publicGateways allows to manage Public Gateways that will be created and
                      attached to the Private Network of the cluster.
                    items:
                      description: PublicGateway defines settings of the Public Gateway
                        that will be created.
                      minProperties: 1
                      properties:
                        ip:
                          description: ip to use when creating a Public Gateway.
                          format: ipv4
                          maxLength: 15
                          minLength: 1
                          type: string
                        type:
                          default: VPC-GW-S
                          description: type is a Public Gateway commercial offer type.
                          maxLength: 20
                          minLength: 1
                          type: string
                        zone:
                          description: |-
                            zone where to create the Public Gateway. Must be in the same region as the
                            cluster. Defaults to the first zone of the region.
                          maxLength: 9
                          minLength: 8
                          pattern: ^[a-z]{2}-[a-z]{3}-[0-9]{0,2}$
                          type: string
                      type: object
                    maxItems: 6
                    minItems: 1
                    type: array
                    x-kubernetes-list-type: atomic
                type: object
              projectID:
                description: projectID in which the managed cluster will be created.
                maxLength: 36
                minLength: 36
                pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$
                type: string
                x-kubernetes-validations:
                - message: Value is immutable
                  rule: self == oldSelf
              region:
                description: region where the managed cluster will be created.
                maxLength: 6
                minLength: 6
                pattern: ^[a-z]{2}-[a-z]{3}$
                type: string
                x-kubernetes-validations:
                - message: Value is immutable
                  rule: self == oldSelf
              scalewaySecretName:
                description: |-
                  scalewaySecretName is the name of the secret that contains the Scaleway client parameters.
                  The following keys are required: SCW_ACCESS_KEY, SCW_SECRET_KEY.
                  The following key is optional: SCW_API_URL.
                maxLength: 253
                minLength: 1
                type: string
            required:
            - projectID
            - region
            - scalewaySecretName
            type: object
            x-kubernetes-validations:
            - message: controlPlaneEndpoint is required once set
              rule: '!has(oldSelf.controlPlaneEndpoint) || has(self.controlPlaneEndpoint)'
            - message: privateNetwork cannot be added or removed
              rule: (has(self.network) && has(self.network.privateNetwork)) == (has(oldSelf.network)
                && has(oldSelf.network.privateNetwork))
          status:
            description: status defines the observed state of ScalewayManagedCluster
            minProperties: 1
            properties:
              conditions:
                description: |-
                  conditions represent the current state of the ScalewayManagedCluster resource.
                  Each condition has a unique type and reflects the status of a specific aspect of the resource.

                  The status of each condition is one of True, False, or Unknown.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                maxItems: 32
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              initialization:
                description: |-
                  initialization provides observations of the ScalewayManagedCluster initialization process.
                  NOTE: Fields in this struct are part of the Cluster API contract and are used to orchestrate initial Cluster provisioning.
                minProperties: 1
                properties:
                  provisioned:
                    description: |-
                      provisioned is true when the infrastructure provider reports that the Cluster's infrastructure is fully provisioned.
                      NOTE: this field is part of the Cluster API contract, and it is used to orchestrate initial Cluster provisioning.
                    type: boolean
                type: object
              network:
                description: network contains information about currently provisioned
                  network resources.
                minProperties: 1
                properties:
                  privateNetworkID:
                    description: privateNetworkID is the ID of the Private Network
                      that is attached to the cluster.
                    maxLength: 36
                    minLength: 36
                    pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$
                    type: string
                type: object
            type: object
        required:
        - spec
        type: object
        x-kubernetes-validations:
        - message: name must be between 1 and 63 characters
          rule: self.metadata.name.size() <= 63
        - message: name must be a valid DNS label
          rule: self.metadata.name.matches('^[a-z0-9]([-a-z0-9]*[a-z0-9])?$')
    served: true
    storage: true
    subresources:
      status: {}
